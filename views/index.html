<!DOCTYPE html>
<html lang="en">

<head>
    <title>Grocery List</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- JS -->
    <script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/1.3.0/handlebars.js"></script>
    <!-- <script src="jquery-3.4.1.min.js"></script> -->
    <!-- <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"></script> -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@8"></script>
    <!-- <script src="/static/js/getrequest.js"></script>
    <script src="/static/js/postrequest.js"></script> -->
    <!-- CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/pure-min.css">
    <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">

</head>
<style>
    /* body {
      font-size: 20px;;
      color: #1E2835;
      background: url("https://img.freepik.com/free-vector/blue-light-sparkles-background-with-copyspace_1017-20091.jpg?size=626&ext=jpg");
      background-size: cover;
      background-repeat: no-repeat;
      opacity: 20%;
    }

    #header {
      text-align: center;
      margin-top: 10%;
      width: 50%;
      padding: 10%;
      margin-left: 27%;
    }
    #showForm {
        margin-left: 80px;
      margin-top: 15%;
      padding: 4%;
      background-color: antiquewhite;
      border: 4px;
      width: 50%;
    }
    #add {
      margin-left:8%;
      width: 30%;
      font: 40px;
    height: 50px;
    font-size: 20px;
    }

    #tblItems {
      text-align: center;
      background: darkturquoise;
      font: 20px sans-serif;
      width: 80%;
      margin-left: 130px;
    }
    
    #updateForm {
    margin-left: 280px;
      margin-top: 10%;
      padding: 4%;
      background-color: antiquewhite;
      border: 4px;
      width: 60%;
      color: black;
    } */
    body {
			background-image:url("https://news.harvard.edu/wp-content/uploads/2019/04/Grocery_Store_Aisle_iStock-961081004_2500.jpg?w=1200&h=800&crop=1");
			background-size:cover;
			background-repeat: no-repeat;
			}

		.container {
			max-width: 1100px;
			padding: 20px;
		}

		.form-control {
			width: 200px;
		}

		.center {
			font-size: 15px;
		}

		#left {
			
			margin-top: 20px;
			width: 60%;
			background-color:hsla(290,60%,70%,0.3);
			
			margin-left: 20%;
			margin-right:20%;
		
			box-shadow: -1px 1px 8px 6px #8888;
		}

		#First {
			margin-top: 10px;
    		margin-left: 352px;
		}

		h1 {
			color: white;
			text-shadow: 2px 2px 4px #000000;
			font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
		}

		table {
			margin-top: -8px;
			width: 80% !important;
			margin-left:10%;
			margin-right: 10%;
			background-color:hsla(290,100%,50%,0.3);
		}

		#title {
			background-color: white;
			border: 1px solid white;
			padding: 20px;
			float:right;
			margin-right:500px;
			margin-top:24px;
			
		}

		.formUp {
			background-color:grey;
			border: 1px solid white;
			padding: 20px;
            width: 60%;
			margin-top: 100x;
			margin-left: 20%;
			margin-right: 20%;
			
			box-shadow: -1px 1px 8px 6px #8888;
		}
		#TableGrocery{
			margin-top: -43px;
			
			
		}
		.btnAdd,.ups{
			-webkit-transition-duration: 0.4s; /* Safari */
  transition-duration: 0.4s;
  background-color:cornflowerblue;
  padding: 10px 24px;
  font-size:20px;
  font-family: serif;

			}
			.btnAdd,.ups:hover {
  background-color: #4CAF50; /* Green */
  color: rgb(255, 255, 255);
} /* Green */	
.cans{
			-webkit-transition-duration: 0.4s; /* Safari */
  transition-duration: 0.4s;
  background-color:rgb(237, 100, 168);
  padding: 10px 24px;
  font-size:20px;
  font-family: serif;

			}
			.cans:hover {
  background-color:blueviolet; /* Green */
  color: rgb(255, 255, 255);
} /* Green */	

		.addItem{
			
  display: inline-block;
  padding: 15px 25px;
  font-size: 24px;
  cursor: pointer;
  text-align: center;
  text-decoration: none;
  outline: none;
  color: #fff;
  background-color: #4CAF50;
  border: none;
  border-radius: 15px;
  box-shadow: 0 9px #999;
}


.addItem:hover {background-color: #3e618e}

.addItem:active {
  background-color: #3e8e41;
  box-shadow: 0 5px #666;
  transform: translateY(4px);
}
.view{
			
			display: inline-block;
			padding: 15px 25px;
			font-size: 24px;
			cursor: pointer;
			text-align: center;
			text-decoration: none;
			outline: none;
			color: #fff;
			background-color: #4CAF50;
			border: none;
			border-radius: 15px;
			box-shadow: 0 9px #999;
		  }
		  
		  
		  .view:hover {background-color: #3e4a8e}
		  
		  .view:active {
			background-color: #3e4a8e;
			box-shadow: 0 5px #666;
			transform: translateY(4px);
		  }
	
		
		.edit{
			background-color: coral;
			border-radius: 50%;
			width:40%
		}
		.delete{
			background-color: darkcyan;
			border-radius: 50%;
			width:40%;
			
		}
		h1{
			font-size: 50%;
			text-align: center;
			color:#3e618e;
		
			
   font: bold 130px Helvetica, Arial, Sans-Serif;
   text-shadow: 1px 1px #026ffe, 
                2px 2px #fe4902, 
                3px 3px #fe4902;
   -webkit-transition: all 0.12s ease-out;
   -moz-transition:    all 0.12s ease-out;
   -ms-transition:     all 0.12s ease-out;
   -o-transition:      all 0.12s ease-out;}
   h1:hover {
   position: relative; 
   top: -3px; 
   left: -3px; 
   text-shadow: 1px 1px #0213fe, 
                2px 2px #0213fe, 
                3px 3px #0213fe, 
                4px 4px #0213fe, 
                5px 5px #0213fe, 
                6px 6px #0213fe;
}
		h3{
			font-family:Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;
			font-size: 50px;
			color:brown
		}
		#item,#itemQ,#itemP{
			font-size:20px;
			font-family:monospace;
			color:hotpink
		}
		.th{
			color: #3e4a8e
		}
		
	</style>
</style>

<body>
    <div>
        <h1>WELCOME</h1>
    </div>
    <div id="First">
        <center>

            <button type="button" class="addItem" id="add">Add Item</button>
            <button type="button" class="view" id="viewTab">View Table</button>
        </center>
    </div>
    <center>
        <div style="display:none" class="formUp" id="updateForm">
            <div class="col-sm-5">
                <h3>Update Item</h3>
                <br>
                <div>
                    <div>
                        <form>
                            <div class="form-group">
                                <label id="itemQ">Item Name:</label>
                                <input type="text" class="form-control" name="itemUpdate" placeholder="Name" value=" "
                                    required=""><br>
                            </div>
                            <div class="form-group">
                                <label id="itemQ">Item Quantity:</label>
                                <input type="number" class="form-control" name="quantityUpdate" placeholder="Quantity"
                                    value="0" min=0 required=""><br>
                            </div>
                            <div class="form-group">
                                <label id="itemQ">Item Priority:</label>
                                <input type="number" class="form-control" name="priorityUpdate" placeholder="Priority"
                                    value="0" min="1" max="3" required="">
                            </div>
                        </form>
                    </div>
                    <div class="card-footer">
                        <button id="updateItem" class="ups">UPDATE</button>
                        <button id="updateCancel" class="cans">CANCEL</button>
                    </div>
                </div>
    </center>
    <center>
        <div id="left">
            <div class="container">
                <div class="col-sm-5">
                    <h3>Add Item</h3>
                    <br>
                    <div>
                        <div id="userForm">
                            <div class="form-group">
                                <label for="name" id="item">Item Name:</label>
                                <input type="text" class="form-control" id="name" name="item" placeholder="Enter Item Name" />
                            </div>
                            <div class="form-group">
                                <label for="quantity" id="itemQ">Item Quantity:</label>
                                <input type="number" class="form-control" id="quantity" name="quantity" placeholder="Enter Item Quantity" />
                            </div>
                            <div class="form-group">
                                <label for="priority" id="itemP">Item Priority:</label>
                                <input type="number" class="form-control" id="priority" name="priority" placeholder="Enter 1-3 " />
                            </div>
                            <button type="submit" class="btnAdd" id="addBtn">Add Item</button>
                            <button type="submit" class="btnCan" id="cancelBtn">Cancel</button>
                        </div>
                    </div>

                    <div id="postResultDiv">
                    </div>
                    <br>
                </div>
            </div>
        </div><br><br><br>
        <div id="TableGrocery">
            <!-- <h1 id="title">Grocery List</h1> -->
            <table class="table">
                <thead class="thead-dark">
                    <tr>
                        <th id="thName" scope="col">Item Name</th>
                        <th id="thQuantity" scope="col">Item Quantity</th>
                        <th id="thPriority" scope="col">Item Priority</th>
                        <th id="thActions" scope="col">Actions</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
        </div>
        <!-- <div id="updateForm" style="display:none">
           
                <div>
                    <h3>Update Item</h3>
                </div>
                <div>
                    <div id="users">
                        <h2>Item name:</h2>
                        <input type="text">
                        <h2>Item Quantity:</h2>
                        <input type="number">
                        <h2>Item Priority:</h2>
                        <input type="number">
                    </div>
                </div>

            </div>

        </div> -->



    </center>






    <!-- Modal -->
    <!-- <div id="updateForm" style="display:none;margin-top:20px;">
        
                <h3>Update Item</h3>
                <br>
                <div>
                    <div>
                        <div >
                            <label for="name" id="item">Item Name:</label>
                            <input type="text" class="form-control" id="name1" name="upitem" placeholder="Enter Item Name" />
                        </div>
                        <div >
                            <label for="quantity" id="itemQ">Item Quantity:</label>
                            <input type="number" class="form-control" id="quantity1" name="upquantity" placeholder="Enter Item Quantity" />
                        </div>
                        <div>
                            <label for="priority" id="itemP">Item Priority:</label>
                            <input type="number" class="form-control" id="priority1" name="uppriority" placeholder="Enter 1-3 " />
                        </div>
                        <button type="submit" class="btnUp" id="updateBtn">Update Item</button>
                        <button type="submit" class="btnCan" id="cancelBtn">Cancel</button>
                    </div>
                </div>

                <div id="postResultDiv">
                </div>
                <br>
            </div>
        </div>
    </div> -->
</body>
<!-- <div id="header" class="card">
        <h2>Create Items Here</h2><br>
        <button id="createBtn" type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal">Create
            Item</button>
    </div>

    <div id="form">
        <center>
            <div class="card" id="showForm" style="display:none;width : 400px;">
                <h3 class="card-header">Add New Item</h3>
                <div>
                    <form action="" class="form was-validated">
                        <div class="form-group">
                            <label for="itemLabel">Item:</label>
                            <input type="text" class="form-control" name="item" placeholder="Enter Item " />
                        </div>

                        <div class="form-group">
                            <label for="qtyLabel">Quantity:</label>
                            <input type="number" class="form-control" name="quantity" placeholder="Enter Quantity" min=0
                                step="1" required />
                        </div>

                        <div class="form-group">
                            <label for="priLabel">Priority:</label>
                            <input type="number" class="form-control" name="priority" placeholder="Enter Priority" min="1"
                                max="3" required />
                        </div>
                    </form>
                </div>
                <div class="card-footer">
                    <button id="addItem" class="btn btn-primary">Save</button>
                    <button id="cancel" class="btn btn-danger">Cancel</button>
                </div>

            </div>
        </center>

        
        <div style="display:none;width : 400px; height:400px;margin-left: 450px; background-color: antiquewhite;" id="updateForm" >
            <div class="card-header text-black" style="text-align: center;">Update Item</div>
            <div class="card-body text-center">
                <form action="" class="form was-validated" >
                    <input type="text" class="form-control" name="itemUpdate" placeholder="Name" value=" " autofocus
                        required=""><br>
                    <input type="number" class="form-control" name="quantityUpdate" placeholder="Quantity" value="0"
                        min=0 required=""><br>
                    <input type="number" class="form-control" name="priorityUpdate" placeholder="Priority" value="0"
                        min="1" max="3" required="">
                </form>
            </div>
            <div class="card-footer">
                <button id="updateItem" class="btn btn-primary">UPDATE</button>
                <button id="updateCancel" class="btn btn-danger">CANCEL</button>
            </div>
        </div>

        <div class="container" style="display:inline;">
            <div id="showTable">
                <br><br>
                <center>
                    <button id="add" class="btn btn-info" data-toggle="modal" data-target="#myModal">ADD
                        ITEM</button>
                    <br><br>
                </center>

                <table class="table text-center table-hover" id="tblItems">
                    <thead class="thead thead-light">
                        <th>Item</th>
                        <th>Quantity</th>
                        <th>Priority</th>
                        <th>Action</th>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
            </div>
        </div>
    </div> -->
<script>
    $(document).ready(function () {
        $("#left").hide();
        $("#TableGrocery").hide();
        $('#updateForm').hide();
        var status = true;
        function retrieveAllData() {
            $.ajax({
                url: "item/retrieve/all",
                crossDomain: true,
                type: "GET",
                success: function (data) {
                    $('tbody').empty();
                    data.forEach(element => {
                        addRow(element);
                    });
                },
                error: function (e) {
                    console.log(e);
                }
            })
        }

        retrieveAllData();

        $("#add").click(function (e) {
            $("#left").show();
            $('#First').hide();
            $('#TableGrocery').hide();
            $('#updateForm').hide();

        })
        $("#viewTab").click(function (e) {
            $("#left").hide();
            $('#First').show();
            $('#TableGrocery').show();
        })


        $("#addBtn").click(function (e) {
            e.preventDefault();
            $("#TableGrocery").show();
            $("#left").hide();
            $("#First").show();
        })

        $("#cancelBtn").on('click', function (e) {
            e.preventDefault();
            $("#left").hide();
            $("#TableGrocery").show();
            $("#First").show();

            let item = $('input[name="item"]').val('');
            let quantity = $('input[name="quantity"]').val('');
            let priority = $('input[name="priority"]').val('');
        })

        $("#updateCancel").on('click', function (e) {
            e.preventDefault();
            $("#updateForm").hide();
            $("#TableGrocery").show();
            $("#First").show();

        })

        function addRow(data) {
            var tr = $("<tr>", {
                id: data._id,
                item: data.item,
                quantity: data.quantity,
                priority: data.priority
            });
            var btns = $("<div>").append($("<button>", {
                class: "btn btn-warning edit"
            }).text("Update"),
                $("<button>", {
                    class: "btn btn-secondary delete",
                }).text("Delete")
            )
            $(tr).append(
                $("<td>").text(data.item),
                $("<td>").text(data.quantity),
                $("<td>").text(data.priority),
                $("<td>").append(btns)
            ).appendTo($('tbody'));
        }


        $("#addBtn").on('click', function (e) {
            e.preventDefault(e);
            var boolean = true;
            var item = $('input[name="item"]');
            var quantity = $('input[name="quantity"]');
            var priority = $('input[name="priority"]');


            $('input').each(function () {
                if ($(this).val() == "") {
                    boolean = false;
                }
            })

            if (boolean == true) {
                $.ajax({
                    url: "item/create",
                    crossDomain: true,
                    type: "POST",
                    data: {
                        item: item.val(),
                        quantity: quantity.val(),
                        priority: priority.val()
                    },
                    success: function (data) {
                        addRow(data);
                        Swal.fire({
                            type: 'success',
                            title: 'Success!',
                            text: "Successfully added to database!",
                            confirmButtonColor: '#3297a',
                        })
                    },
                    error: function (e) {
                        console.log(e);
                    }
                })
                item.val('');
                quantity.val('');
                priority.val('');
                $("#left").hide();
                $("#TableGrocery").show();
            }
            else {
                Swal.fire({
                    type: 'error',
                    title: 'Oops...',
                    text: 'Please fill all the fields!',
                })
            }

        });


        $(document).on("click", ".delete", function () {
            $(this).parent().parent().parent().fadeOut();
            deleteItem($(this).parent().parent().parent().attr("id"));
        })

        function deleteItem(id) {
            $.ajax({
                url: "item/delete/" + id + "",
                crossDomain: true,
                type: "DELETE",
                success: function (data) {
                    console.log(data);
                },
                error: function (e) {
                    console.log(e);
                }
            })
        }

        var updateId;
        $(document).on("click", ".edit", function () {
            status = false;
            retrieveOneItem($(this).parent().parent().parent().attr("id"));
            updateId = $(this).parent().parent().parent().attr("id");
            $("#updateForm").show();
            $("#TableGrocery").hide();
            $("#First").hide();


        })
        $(document).on("click", "#updateItem", function () {
            updateItem(updateId);
            retrieveAllData();
            $("#updateForm").hide();
            $("#TableGrocery").show();
            $("#First").show();

        })


        function updateItem(id) {
            var item = $('input[name="itemUpdate"]');
            var quantity = $('input[name="quantityUpdate"]');
            var priority = $('input[name="priorityUpdate"]');
            $.ajax({
                url: "item/update/" + id + "",
                crossDomain: true,
                type: "PUT",
                data: {
                    item: item.val(),
                    quantity: quantity.val(),
                    priority: priority.val()
                },
                success: function (data) {
                    console.log(data);
                },
                error: function (e) {
                    console.log(e);
                }
            })
        }

        function retrieveOneItem(id) {
            $.ajax({
                url: "item/retrieve/" + id + "",
                crossDomain: true,
                type: "GET",
                success: function (data) {
                    $('input[name="itemUpdate"]').val(data.item);
                    $('input[name="quantityUpdate"]').val(data.quantity);
                    $('input[name="priorityUpdate"]').val(data.priority);
                },
                error: function (e) {
                    console.log(e);
                }
            })
        }
    });
</script>
</body>

</html>